from WindPy import w
import pandas as pd


stock_codes = ['000001.SZ', '000001.SH']
w.start()
codes = ['078060.IB', '122000.SH', '136436.SH', '101751003.IB', '038007.IB', '038018.IB', '050217.IB', '058004.IB', '058009.IB', '058021.IB', '058022.IB', '058030.IB', '058036.IB', '068008.IB', '068028.IB', '068041.IB', '068046.IB', '0700002.IB', '0700005.IB', '0700006.IB', '070218.IB', '078043.IB', '078049.IB', '078055.IB', '078062.IB', '080002.IB', '088012.IB', '0980168.IB', '098078.IB', '098097.IB', '1006001.IB', '101001.IB', '1080112.IB', '1107001.IB', '1115001.IB', '1120004.IB', '1120007.IB', '120306.SH', '1212001.IB', '122001.SH', '122004.SH', '1280280.IB', '090702.IB', '1282506.IB', '1180093.IB', '122190.SH', '122192.SH', '1280313.IB', '1220030.IB', '112504.SZ', '127488.SH', '136256.SH', '143071.SH', '150207.IB', '150208.IB', '101651023.IB', '019810.SH', '019813.SH', '068047.IB', '090215.IB', '1109001.IB', '111026.SZ', '1120009.IB', '122175.SH', '122218.SH', '122252.SH', '122260.SH', '1282414.IB', '1380025.IB', '090602.IB', '098013.IB', '1080127.IB', '1080143.IB', '1080166.IB', '1302205.IB', '1080150.IB', '1282237.IB', '1282421.IB', '1282485.IB', '1282538.IB', '130229.IB', '130245.IB', '140219.IB', '101551061.IB', '160208.IB', '1382074.IB', '101454068.IB', '150223.IB', '150317.IB', '150402.IB', '160402.IB', '101756020.IB', '101759023.IB', '101769004.IB', '010303.SH', '080006.IB', '080013.IB', '090030.IB', '1106001.IB', '111023.SZ', '1182326.IB', '1202204.IB', '120303.SH', '1207001.IB', '1209002.IB', '1211003.IB', '1220031.IB', '122234.SH', '1280126.IB', '1282092.IB', '130240.IB', '130247.IB', '1380076.IB', '140027.IB', '140205.IB', '090705.IB'
]
vars = ['balanceDate=20170630;yield=4.7205;bondPriceType=2;maturityDate=20170927;paymentFreq=1;parRate=5.55;parValue=100;valueDate=20070927;issuePrice=100.0', 'balanceDate=20170630;yield=4.6229;bondPriceType=2;maturityDate=20170924;paymentFreq=1;parRate=5.35;parValue=100;valueDate=20070924;issuePrice=100.0', 'balanceDate=20170630;yield=5.0462;bondPriceType=2;maturityDate=20190519;paymentFreq=1;parRate=3.5000000000000004;parValue=100;valueDate=20160519;issuePrice=100.0', 'balanceDate=20170630;yield=5.2841;bondPriceType=2;maturityDate=20200417;paymentFreq=1;parRate=4.87;parValue=100;valueDate=20170417;issuePrice=100.0', 'balanceDate=20170630;yield=4.9338;bondPriceType=2;maturityDate=20210825;paymentFreq=1;parRate=4.63;parValue=100;valueDate=20030825;issuePrice=100.0', 'balanceDate=20170630;yield=5.2696;bondPriceType=2;maturityDate=20231212;paymentFreq=2;parRate=5.1;parValue=100;valueDate=20031212;issuePrice=100.0', 'balanceDate=20170630;yield=4.6951;bondPriceType=2;maturityDate=20250830;paymentFreq=2;parRate=4.1000000000000005;parValue=100;valueDate=20050830;issuePrice=100.0', 'balanceDate=20170630;yield=4.9540999999999995;bondPriceType=2;maturityDate=20200429;paymentFreq=1;parRate=5.28;parValue=100;valueDate=20050429;issuePrice=100.0', 'balanceDate=20170630;yield=4.9544;bondPriceType=2;maturityDate=20200629;paymentFreq=1;parRate=5.3;parValue=100;valueDate=20050629;issuePrice=100.0', 'balanceDate=20170630;yield=4.9549;bondPriceType=2;maturityDate=20200727;paymentFreq=1;parRate=5.18;parValue=100;valueDate=20050727;issuePrice=100.0', 'balanceDate=20170630;yield=4.9220999999999995;bondPriceType=2;maturityDate=20200729;paymentFreq=1;parRate=4.8500000000000005;parValue=100;valueDate=20050729;issuePrice=100.0', 'balanceDate=20170630;yield=4.961499999999999;bondPriceType=2;maturityDate=20201104;paymentFreq=1;parRate=4.8;parValue=100;valueDate=20051104;issuePrice=100.0', 'balanceDate=20170630;yield=4.9669;bondPriceType=2;maturityDate=20201226;paymentFreq=1;parRate=4.7;parValue=100;valueDate=20051226;issuePrice=100.0', 'balanceDate=20170630;yield=4.975299999999999;bondPriceType=2;maturityDate=20210307;paymentFreq=1;parRate=4.05;parValue=100;valueDate=20060307;issuePrice=100.0', 'balanceDate=20170630;yield=4.9319;bondPriceType=2;maturityDate=20210529;paymentFreq=1;parRate=4.1000000000000005;parValue=100;valueDate=20060529;issuePrice=100.0', 'balanceDate=20170630;yield=5.171899999999999;bondPriceType=2;maturityDate=20261017;paymentFreq=1;parRate=4.15;parValue=100;valueDate=20061017;issuePrice=100.0', 'balanceDate=20170630;yield=5.1723;bondPriceType=2;maturityDate=20261115;paymentFreq=1;parRate=3.95;parValue=100;valueDate=20061115;issuePrice=100.0', 'balanceDate=20170630;yield=4.0024;bondPriceType=2;maturityDate=20220918;paymentFreq=2;parRate=4.68;parValue=100;valueDate=20070918;issuePrice=100.0', 'balanceDate=20170630;yield=3.7246;bondPriceType=2;maturityDate=20171105;paymentFreq=2;parRate=4.49;parValue=100;valueDate=20071105;issuePrice=100.0', 'balanceDate=20170630;yield=4.0127999999999995;bondPriceType=2;maturityDate=20221119;paymentFreq=2;parRate=4.6899999999999995;parValue=100;valueDate=20071119;issuePrice=100.0', 'balanceDate=20170630;yield=3.9626;bondPriceType=2;maturityDate=20170918;paymentFreq=1;parRate=4.53;parValue=100;valueDate=20070918;issuePrice=100.0', 'balanceDate=20170630;yield=4.798;bondPriceType=2;maturityDate=20170827;paymentFreq=1;parRate=5.3;parValue=100;valueDate=20070827;issuePrice=100.0', 'balanceDate=20170630;yield=4.7616;bondPriceType=2;maturityDate=20170907;paymentFreq=1;parRate=5.2;parValue=100;valueDate=20070907;issuePrice=100.0', 'balanceDate=20170630;yield=4.7269;bondPriceType=2;maturityDate=20170921;paymentFreq=1;parRate=5.510000000000001;parValue=100;valueDate=20070921;issuePrice=100.0', 'balanceDate=20170630;yield=4.7245;bondPriceType=2;maturityDate=20171012;paymentFreq=1;parRate=5.680000000000001;parValue=100;valueDate=20071012;issuePrice=100.0', 'balanceDate=20170630;yield=4.033899999999999;bondPriceType=2;maturityDate=20230228;paymentFreq=2;parRate=4.16;parValue=100;valueDate=20080228;issuePrice=100.0', 'balanceDate=20170630;yield=5.2415;bondPriceType=2;maturityDate=20230618;paymentFreq=1;parRate=6.2;parValue=100;valueDate=20080618;issuePrice=100.0', 'balanceDate=20170630;yield=4.952999999999999;bondPriceType=2;maturityDate=20191125;paymentFreq=1;parRate=5.0;parValue=100;valueDate=20091125;issuePrice=100.0', 'balanceDate=20170630;yield=4.9452;bondPriceType=2;maturityDate=20190508;paymentFreq=1;parRate=4.3999999999999995;parValue=100;valueDate=20090508;issuePrice=100.0', 'balanceDate=20170630;yield=5.05;bondPriceType=2;maturityDate=20190602;paymentFreq=1;parRate=4.45;parValue=100;valueDate=20090602;issuePrice=100.0', 'balanceDate=20170630;yield=5.0384;bondPriceType=2;maturityDate=20200311;paymentFreq=1;parRate=4.68;parValue=100;valueDate=20100311;issuePrice=100.0', 'balanceDate=20170630;yield=5.1888;bondPriceType=2;maturityDate=20200330;paymentFreq=1;parRate=4.8;parValue=100;valueDate=20100330;issuePrice=100.0', 'balanceDate=20170630;yield=5.6126;bondPriceType=2;maturityDate=20250928;paymentFreq=1;parRate=4.95;parValue=100;valueDate=20100928;issuePrice=100.0', 'balanceDate=20170630;yield=5.1079;bondPriceType=2;maturityDate=20211107;paymentFreq=1;parRate=5.7;parValue=100;valueDate=20111107;issuePrice=100.0', 'balanceDate=20170630;yield=5.156000000000001;bondPriceType=2;maturityDate=20211024;paymentFreq=1;parRate=5.75;parValue=100;valueDate=20111024;issuePrice=100.0', 'balanceDate=20170630;yield=5.4996;bondPriceType=2;maturityDate=20260524;paymentFreq=1;parRate=5.800000000000001;parValue=100;valueDate=20110524;issuePrice=100.0', 'balanceDate=20170630;yield=5.2724;bondPriceType=2;maturityDate=20210909;paymentFreq=1;parRate=6.480000000000001;parValue=100;valueDate=20110909;issuePrice=100.0', 'balanceDate=20170630;yield=4.9255;bondPriceType=2;maturityDate=20181208;paymentFreq=1;parRate=5.0200000000000005;parValue=100;valueDate=20031208;issuePrice=100.0', 'balanceDate=20170630;yield=5.3084;bondPriceType=2;maturityDate=20220621;paymentFreq=1;parRate=5.1499999999999995;parValue=100;valueDate=20120621;issuePrice=100.0', 'balanceDate=20170630;yield=4.7587;bondPriceType=2;maturityDate=20171109;paymentFreq=1;parRate=5.7700000000000005;parValue=100;valueDate=20071109;issuePrice=100.0', 'balanceDate=20170630;yield=4.8384;bondPriceType=2;maturityDate=20171225;paymentFreq=1;parRate=5.8999999999999995;parValue=100;valueDate=20071225;issuePrice=100.0', 'balanceDate=20170630;yield=4.911899999999999;bondPriceType=2;maturityDate=20320912;paymentFreq=1;parRate=5.140000000000001;parValue=100;valueDate=20120912;issuePrice=100.0', 'balanceDate=20170630;yield=5.0475;bondPriceType=2;maturityDate=20190226;paymentFreq=1;parRate=4.0;parValue=100;valueDate=20090226;issuePrice=100.0', 'balanceDate=20170630;yield=5.0785;bondPriceType=2;maturityDate=20171128;paymentFreq=1;parRate=5.7;parValue=100;valueDate=20121128;issuePrice=100.0', 'balanceDate=20170630;yield=5.040699999999999;bondPriceType=2;maturityDate=20180421;paymentFreq=1;parRate=5.24;parValue=100;valueDate=20110421;issuePrice=100.0', 'balanceDate=20170630;yield=5.138399999999999;bondPriceType=2;maturityDate=20191024;paymentFreq=1;parRate=5.2;parValue=100;valueDate=20121024;issuePrice=100.0', 'balanceDate=20170630;yield=5.2764999999999995;bondPriceType=2;maturityDate=20221024;paymentFreq=1;parRate=5.1;parValue=100;valueDate=20121024;issuePrice=100.0', 'balanceDate=20170630;yield=5.3038;bondPriceType=2;maturityDate=20171011;paymentFreq=1;parRate=6.29;parValue=100;valueDate=20121011;issuePrice=100.0', 'balanceDate=20170630;yield=5.1011;bondPriceType=2;maturityDate=20171228;paymentFreq=1;parRate=5.8999999999999995;parValue=100;valueDate=20121228;issuePrice=100.0', 'balanceDate=20170630;yield=5.595899999999999;bondPriceType=2;maturityDate=20220315;paymentFreq=1;parRate=5.1;parValue=100;valueDate=20170315;issuePrice=100.0', 'balanceDate=20170630;yield=5.567399999999999;bondPriceType=2;maturityDate=20240410;paymentFreq=1;parRate=4.88;parValue=100;valueDate=20170410;issuePrice=100.0', 'balanceDate=20170630;yield=4.937399999999999;bondPriceType=2;maturityDate=20190303;paymentFreq=1;parRate=2.97;parValue=100;valueDate=20160303;issuePrice=100.0', 'balanceDate=20170630;yield=5.0919;bondPriceType=2;maturityDate=20220418;paymentFreq=1;parRate=4.58;parValue=100;valueDate=20170418;issuePrice=100.0', 'balanceDate=20170630;yield=4.2993;bondPriceType=2;maturityDate=20180403;paymentFreq=1;parRate=4.18;parValue=100;valueDate=20150403;issuePrice=100.0', 'balanceDate=20170630;yield=4.6513;bondPriceType=2;maturityDate=20200413;paymentFreq=1;parRate=4.130000000000001;parValue=100;valueDate=20150413;issuePrice=100.0', 'balanceDate=20170630;yield=4.910299999999999;bondPriceType=2;maturityDate=20190422;paymentFreq=1;parRate=3.4000000000000004;parValue=100;valueDate=20160422;issuePrice=100.0', 'balanceDate=20170630;yield=3.9587999999999997;bondPriceType=2;maturityDate=20180623;paymentFreq=2;parRate=4.41;parValue=100;valueDate=20080623;issuePrice=100.0', 'balanceDate=20170630;yield=4.116899999999999;bondPriceType=2;maturityDate=20280811;paymentFreq=2;parRate=4.94;parValue=100;valueDate=20080811;issuePrice=100.0', 'balanceDate=20170630;yield=5.316;bondPriceType=2;maturityDate=20361115;paymentFreq=1;parRate=4.1000000000000005;parValue=100;valueDate=20061115;issuePrice=100.0', 'balanceDate=20170630;yield=4.8576;bondPriceType=2;maturityDate=20191013;paymentFreq=1;parRate=5.0;parValue=100;valueDate=20091013;issuePrice=100.0', 'balanceDate=20170630;yield=5.277399999999999;bondPriceType=2;maturityDate=20211013;paymentFreq=1;parRate=6.150000000000001;parValue=100;valueDate=20111013;issuePrice=100.0', 'balanceDate=20170630;yield=4.9544;bondPriceType=2;maturityDate=20200629;paymentFreq=1;parRate=5.3;parValue=100;valueDate=20050629;issuePrice=100.0', 'balanceDate=20170630;yield=5.3827;bondPriceType=2;maturityDate=20211121;paymentFreq=1;parRate=6.0;parValue=100;valueDate=20111121;issuePrice=100.0', 'balanceDate=20170630;yield=5.2897;bondPriceType=2;maturityDate=20270809;paymentFreq=1;parRate=5.1499999999999995;parValue=100;valueDate=20120809;issuePrice=100.0', 'balanceDate=20170630;yield=5.079199999999999;bondPriceType=2;maturityDate=20230118;paymentFreq=1;parRate=5.1;parValue=100;valueDate=20130118;issuePrice=100.0', 'balanceDate=20170630;yield=5.2218;bondPriceType=2;maturityDate=20230422;paymentFreq=1;parRate=5.0;parValue=100;valueDate=20130422;issuePrice=100.0', 'balanceDate=20170630;yield=5.138200000000001;bondPriceType=2;maturityDate=20230607;paymentFreq=1;parRate=5.050000000000001;parValue=100;valueDate=20130607;issuePrice=100.0', 'balanceDate=20170630;yield=5.1354;bondPriceType=2;maturityDate=20221023;paymentFreq=1;parRate=5.18;parValue=100;valueDate=20121023;issuePrice=100.0', 'balanceDate=20170630;yield=5.1796;bondPriceType=2;maturityDate=20280123;paymentFreq=1;parRate=5.1;parValue=100;valueDate=20130123;issuePrice=100.0', 'balanceDate=20170630;yield=5.0356;bondPriceType=2;maturityDate=20190708;paymentFreq=1;parRate=4.0;parValue=100;valueDate=20090708;issuePrice=100.0', 'balanceDate=20170630;yield=5.1559;bondPriceType=2;maturityDate=20190220;paymentFreq=1;parRate=6.0;parValue=100;valueDate=20090220;issuePrice=100.0', 'balanceDate=20170630;yield=5.067799999999999;bondPriceType=2;maturityDate=20201019;paymentFreq=1;parRate=5.12;parValue=100;valueDate=20101019;issuePrice=100.0', 'balanceDate=20170630;yield=5.1715;bondPriceType=2;maturityDate=20201116;paymentFreq=1;parRate=5.53;parValue=100;valueDate=20101116;issuePrice=100.0', 'balanceDate=20170630;yield=6.2273000000000005;bondPriceType=2;maturityDate=20201217;paymentFreq=1;parRate=6.76;parValue=100;valueDate=20101217;issuePrice=100.0', 'balanceDate=20170630;yield=5.0599;bondPriceType=2;maturityDate=20630801;paymentFreq=2;parRate=5.4;parValue=100;valueDate=20130801;issuePrice=100.0', 'balanceDate=20170630;yield=4.9704;bondPriceType=2;maturityDate=20171201;paymentFreq=1;parRate=5.1;parValue=100;valueDate=20101201;issuePrice=100.0', 'balanceDate=20170630;yield=4.0752;bondPriceType=2;maturityDate=20170702;paymentFreq=1;parRate=5.35;parValue=100;valueDate=20120702;issuePrice=100.0', 'balanceDate=20170630;yield=5.0586;bondPriceType=2;maturityDate=20171025;paymentFreq=1;parRate=6.3;parValue=100;valueDate=20121025;issuePrice=100.0', 'balanceDate=20170630;yield=4.9639;bondPriceType=2;maturityDate=20171121;paymentFreq=1;parRate=5.54;parValue=100;valueDate=20121121;issuePrice=100.0', 'balanceDate=20170630;yield=4.9782;bondPriceType=2;maturityDate=20171213;paymentFreq=1;parRate=5.12;parValue=100;valueDate=20121213;issuePrice=100.0', 'balanceDate=20170630;yield=4.3787;bondPriceType=2;maturityDate=20180718;paymentFreq=1;parRate=4.0205;parValue=100;valueDate=20130718;issuePrice=100.0', 'balanceDate=20170630;yield=4.4201999999999995;bondPriceType=2;maturityDate=20181024;paymentFreq=1;parRate=4.97;parValue=100;valueDate=20131024;issuePrice=100.0', 'balanceDate=20170630;yield=4.4826999999999995;bondPriceType=2;maturityDate=20190724;paymentFreq=1;parRate=4.92;parValue=100;valueDate=20140724;issuePrice=100.0', 'balanceDate=20170630;yield=4.8886;bondPriceType=2;maturityDate=20181106;paymentFreq=1;parRate=3.2800000000000002;parValue=100;valueDate=20151106;issuePrice=100.0', 'balanceDate=20170630;yield=4.5786;bondPriceType=2;maturityDate=20190303;paymentFreq=1;parRate=2.7199999999999998;parValue=100;valueDate=20160303;issuePrice=100.0', 'balanceDate=20170630;yield=4.9033999999999995;bondPriceType=2;maturityDate=20180305;paymentFreq=1;parRate=4.84;parValue=100;valueDate=20130305;issuePrice=100.0', 'balanceDate=20170630;yield=4.9718;bondPriceType=2;maturityDate=20171203;paymentFreq=1;parRate=4.5;parValue=100;valueDate=20141203;issuePrice=100.0', 'balanceDate=20170630;yield=4.513299999999999;bondPriceType=2;maturityDate=20181104;paymentFreq=1;parRate=2.98;parValue=100;valueDate=20151104;issuePrice=100.0', 'balanceDate=20170630;yield=4.5158;bondPriceType=2;maturityDate=20181130;paymentFreq=1;parRate=3.18;parValue=100;valueDate=20151130;issuePrice=100.0', 'balanceDate=20170630;yield=4.6166;bondPriceType=2;maturityDate=20200114;paymentFreq=1;parRate=4.019999999999999;parValue=100;valueDate=20150114;issuePrice=100.0', 'balanceDate=20170630;yield=4.5474;bondPriceType=2;maturityDate=20190106;paymentFreq=1;parRate=2.77;parValue=100;valueDate=20160106;issuePrice=100.0', 'balanceDate=20170630;yield=5.4509;bondPriceType=2;maturityDate=20200526;paymentFreq=1;parRate=5.7299999999999995;parValue=100;valueDate=20170526;issuePrice=100.0', 'balanceDate=20170630;yield=5.348199999999999;bondPriceType=2;maturityDate=20200417;paymentFreq=1;parRate=4.9799999999999995;parValue=100;valueDate=20170417;issuePrice=100.0', 'balanceDate=20170630;yield=7.113200000000002;bondPriceType=2;maturityDate=20220320;paymentFreq=1;parRate=6.49;parValue=100;valueDate=20170320;issuePrice=100.0', 'balanceDate=20170630;yield=4.185199999999999;bondPriceType=2;maturityDate=20230417;paymentFreq=2;parRate=3.4000000000000004;parValue=100;valueDate=20030417;issuePrice=102.14', 'balanceDate=20170630;yield=4.4364;bondPriceType=2;maturityDate=20380508;paymentFreq=2;parRate=4.5;parValue=100;valueDate=20080508;issuePrice=100.0', 'balanceDate=20170630;yield=4.116899999999999;bondPriceType=2;maturityDate=20280811;paymentFreq=2;parRate=4.94;parValue=100;valueDate=20080811;issuePrice=100.0', 'balanceDate=20170630;yield=4.5465;bondPriceType=2;maturityDate=20591130;paymentFreq=2;parRate=4.3;parValue=100;valueDate=20091130;issuePrice=100.0', 'balanceDate=20170630;yield=5.0839;bondPriceType=2;maturityDate=20210519;paymentFreq=1;parRate=5.3;parValue=100;valueDate=20110519;issuePrice=100.0', 'balanceDate=20170630;yield=4.9338;bondPriceType=2;maturityDate=20210825;paymentFreq=1;parRate=4.63;parValue=100;valueDate=20030825;issuePrice=100.0', 'balanceDate=20170630;yield=5.023499999999999;bondPriceType=2;maturityDate=20211117;paymentFreq=1;parRate=5.3;parValue=100;valueDate=20111117;issuePrice=100.0', 'balanceDate=20170630;yield=5.0579;bondPriceType=2;maturityDate=20620628;paymentFreq=2;parRate=5.2;parValue=100;valueDate=20120628;issuePrice=100.0', 'balanceDate=20170630;yield=5.2531;bondPriceType=2;maturityDate=20330801;paymentFreq=1;parRate=4.859999999999999;parValue=100;valueDate=20030801;issuePrice=100.0', 'balanceDate=20170630;yield=5.1903999999999995;bondPriceType=2;maturityDate=20221122;paymentFreq=1;parRate=4.99;parValue=100;valueDate=20121122;issuePrice=100.0', 'balanceDate=20170630;yield=5.3789;bondPriceType=2;maturityDate=20221228;paymentFreq=1;parRate=5.2;parValue=100;valueDate=20121228;issuePrice=100.0', 'balanceDate=20170630;yield=5.3789;bondPriceType=2;maturityDate=20221228;paymentFreq=1;parRate=5.2;parValue=100;valueDate=20121228;issuePrice=100.0', 'balanceDate=20170630;yield=5.6987;bondPriceType=2;maturityDate=20221228;paymentFreq=1;parRate=5.99;parValue=100;valueDate=20121228;issuePrice=100.0', 'balanceDate=20170630;yield=5.2482;bondPriceType=2;maturityDate=20230305;paymentFreq=1;parRate=5.1499999999999995;parValue=100;valueDate=20130305;issuePrice=100.0', 'balanceDate=20170630;yield=5.4269;bondPriceType=2;maturityDate=20220425;paymentFreq=1;parRate=5.88;parValue=100;valueDate=20120425;issuePrice=100.0', 'balanceDate=20170630;yield=5.065099999999999;bondPriceType=2;maturityDate=20220329;paymentFreq=1;parRate=5.18;parValue=100;valueDate=20120329;issuePrice=100.0', 'balanceDate=20170630;yield=4.7012;bondPriceType=2;maturityDate=20230902;paymentFreq=1;parRate=4.72;parValue=100;valueDate=20130902;issuePrice=100.0', 'balanceDate=20170630;yield=4.706799999999999;bondPriceType=2;maturityDate=20231024;paymentFreq=1;parRate=5.04;parValue=100;valueDate=20131024;issuePrice=100.0', 'balanceDate=20170630;yield=5.4433;bondPriceType=2;maturityDate=20280227;paymentFreq=1;parRate=5.1499999999999995;parValue=100;valueDate=20130227;issuePrice=100.0', 'balanceDate=20170630;yield=4.5527999999999995;bondPriceType=2;maturityDate=20641124;paymentFreq=2;parRate=4.24;parValue=100;valueDate=20141124;issuePrice=100.0', 'balanceDate=20170630;yield=4.71;bondPriceType=2;maturityDate=20240120;paymentFreq=1;parRate=5.8999999999999995;parValue=100;valueDate=20140120;issuePrice=100.0', 'balanceDate=20170630;yield=5.0372;bondPriceType=2;maturityDate=20191222;paymentFreq=1;parRate=4.8;parValue=100;valueDate=20091222;issuePrice=100.0'
]

for i in range(len(codes)):
    print(i)
    what = w.wss(codes[i], "calc_price", vars[i])
    what = pd.DataFrame(what.Data, index=what.Fields, columns=['info'])
    print(what)
    price = what.loc['CALC_PRICE', 'info']
    print(price)

w.stop()
